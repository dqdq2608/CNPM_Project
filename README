ğŸ” JOJOâ€™s Burger â€“ Microservices E-Commerce System
Há»‡ thá»‘ng thÆ°Æ¡ng máº¡i Ä‘iá»‡n tá»­ Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn kiáº¿n trÃºc Microservices, bao gá»“m:


Catalog Service (PostgreSQL)


Basket Service (Redis)


Order Service (PostgreSQL)


Payment Service (Mock)


IdentityServer (Authentication)


BFF (Backend For Frontend â€“ Duende BFF)


Kong API Gateway


React Frontend


Docker Compose há»— trá»£ full-stack



ğŸ“š Má»¥c Lá»¥c


1. Giá»›i thiá»‡u


2. Kiáº¿n trÃºc há»‡ thá»‘ng


3. Luá»“ng hoáº¡t Ä‘á»™ng tá»•ng thá»ƒ


4. CÃ¡c dá»‹ch vá»¥


Catalog API


Basket API


Order API


Payment API


IdentityServer


BFF




5. API Gateway (Kong)


6. Frontend React


7. Cháº¡y há»‡ thá»‘ng


8. Luá»“ng Ä‘áº·t hÃ ng & thanh toÃ¡n


9. Ghi chÃº má»Ÿ rá»™ng



ğŸ§© 1. Giá»›i thiá»‡u
Jojoâ€™s Burger lÃ  há»‡ thá»‘ng microservices mÃ´ phá»ng ná»n táº£ng thÆ°Æ¡ng máº¡i Ä‘iá»‡n tá»­:


NgÆ°á»i dÃ¹ng Ä‘Äƒng nháº­p qua IdentityServer


FE giao tiáº¿p BFF Ä‘áº£m báº£o báº£o máº­t


Kong Ä‘á»©ng lÃ m API Gateway phÃ¢n phá»‘i request


Má»—i service cháº¡y Ä‘á»™c láº­p, database tÃ¡ch riÃªng


Basket dÃ¹ng Redis tá»‘c Ä‘á»™ cao


Order + Payment workflow rÃµ rÃ ng



ğŸ— 2. Kiáº¿n trÃºc há»‡ thá»‘ng
SÆ¡ Ä‘á»“ kiáº¿n trÃºc tá»•ng thá»ƒ
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚                React Frontend                â”‚
                            â”‚  HTTPS, Axios, Cookie Auth, CSRF, Secure     â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                â”‚ https://localhost:7082
                                                â–¼
                                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                  â”‚           BFF (Duende)           â”‚
                                  â”‚  /bff             /bff-api/*     â”‚
                                  â”‚  Login, Cookies, CSRF, Proxy     â”‚
                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                 â”‚ https://localhost:8443
                                                 â–¼
                                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                   â”‚         Kong Gateway         â”‚
                                   â”‚ Routing /catalog /basket     â”‚
                                   â”‚         /order /payment      â”‚
                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â–¼                     â–¼                    â–¼                      â–¼                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Catalog.API â”‚     â”‚ Basket.API    â”‚     â”‚ Order.API     â”‚      â”‚ Payment.API   â”‚         â”‚ IdentityServer â”‚
â”‚ PostgreSQL  â”‚     â”‚ Redis         â”‚     â”‚ PostgreSQL     â”‚      â”‚ Mock Provider â”‚         â”‚ Auth + Token   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


ğŸ” 3. Luá»“ng hoáº¡t Ä‘á»™ng tá»•ng thá»ƒ
ÄÄƒng nháº­p


FE â†’ /bff/login


IdentityServer xÃ¡c thá»±c


BFF set 3 cookie báº£o máº­t:


CookieMÃ´ táº£__Host-bffSession cá»§a user__Host-bff-afAnti-forgery token__Host-bff-csrfToken CSRF real-time


FE gá»i /bff/user Ä‘á»ƒ láº¥y thÃ´ng tin phiÃªn Ä‘Äƒng nháº­p



Load catalog
FE gá»i:
GET https://localhost:8443/catalog/api/catalog/catalogtypes-with-pics

Kong â†’ Catalog.API â†’ tráº£ danh sÃ¡ch category + áº£nh

Giá» hÃ ng (Basket)
FE gá»i:
GET     /bff-api/basket
POST    /bff-api/basket
DELETE  /bff-api/basket

BFF tá»± gáº¯n header:
X-User-Sub: <id_user>

â†’ Basket.API â†’ Redis

Äáº·t hÃ ng (Order Flow)


FE nháº¥n checkout


FE POST:


POST /bff-api/order



BFF â†’ Order.API


Order API táº¡o order (status = PendingPayment)


Order API gá»i Payment API


Náº¿u thÃ nh cÃ´ng: status = Paid


FE fetch lá»‹ch sá»­ qua /bff-api/order/list



ğŸ§± 4. CÃ¡c dá»‹ch vá»¥
4.1 Catalog.API


LÆ°u sáº£n pháº©m & category


áº¢nh Ä‘Æ°á»£c tráº£ tháº³ng tá»« API


Database: PostgreSQL


Kong route: /catalog/api/catalog/*



4.2 Basket.API


LÆ°u giá» hÃ ng theo buyerId = claim sub


LÆ°u Redis


API:


GET    /api/basket
POST   /api/basket
DELETE /api/basket


4.3 Order.API


Táº¡o Ä‘Æ¡n hÃ ng


LÆ°u DB PostgreSQL


Gá»i Payment API


API:


POST /api/order
GET  /api/order/list


4.4 Payment.API


Mock xá»­ lÃ½ thanh toÃ¡n


LuÃ´n pháº£n há»“i success (hoáº·c random)


API:


POST /api/payment


4.5 IdentityServer


Cáº¥p token cho BFF


CÃ¡c scope: openid, profile, api, roles, offline_access



4.6 BFF (Backend For Frontend)
Chá»‹u trÃ¡ch nhiá»‡m:


Login


Cookie Auth


CSRF


Proxy an toÃ n Ä‘áº¿n services khÃ¡c


Inject header X-User-Sub


CÃ¡c route chÃ­nh:
/bff/login
/bff/logout
/bff/user
/bff-api/basket
/bff-api/order


ğŸŒ‰ 5. API Gateway (Kong)
VÃ­ dá»¥ routing Catalog:
- name: catalog
  url: http://catalog-api:8080
  routes:
    - name: catalog-route
      paths:
        - /catalog/api/catalog
      strip_path: true

Basket:
- name: basket
  url: http://basket-api:8080
  routes:
    - name: basket-route
      paths:
        - /basket/api/basket
      strip_path: true

Order:
- name: order
  url: http://order-api:8080
  routes:
    - name: order-route
      paths:
        - /order/api/order
      strip_path: true

Payment:
- name: payment
  url: http://payment-api:8080
  routes:
    - name: payment-route
      paths:
        - /payment/api/payment
      strip_path: true


âš› 6. Frontend React
.env
REACT_APP_API_BASE=https://localhost:7082
REACT_APP_CATALOG_API_BASE=https://localhost:8443/catalog
REACT_APP_BASKET_API_BASE=https://localhost:7082/bff-api/basket
REACT_APP_ORDER_API_BASE=https://localhost:7082/bff-api/order

Cháº¡y FE
npm install
npm start


ğŸ³ 7. Cháº¡y há»‡ thá»‘ng
Cháº¡y toÃ n bá»™ backend + gateway + databases:
docker compose up --build

Services sáº½ cháº¡y táº¡i:
ServiceURLBFFhttps://localhost:7082Konghttps://localhost:8443IdentityServerhttps://localhost:5001Catalog.APIhttp://localhost:7002Basket.APIhttp://localhost:5005Order.APIhttp://localhost:5010Payment.APIhttp://localhost:5015Frontendhttps://localhost:3000

ğŸ’³ 8. Luá»“ng Ä‘áº·t hÃ ng & thanh toÃ¡n
1ï¸âƒ£ FE láº¥y giá» hÃ ng:
GET /bff-api/basket

2ï¸âƒ£ FE gá»­i Ä‘áº·t hÃ ng:
POST /bff-api/order
{
  "shippingAddress": "...",
  "paymentMethod": "VISA"
}

3ï¸âƒ£ BFF â†’ Order.API (kÃ¨m X-User-Sub)
4ï¸âƒ£ Order.API xá»­ lÃ½:


Láº¥y giá» hÃ ng tá»« Basket.API


Táº¡o Order


Gá»i Payment API


LÆ°u tráº¡ng thÃ¡i


5ï¸âƒ£ FE load danh sÃ¡ch Ä‘Æ¡n hÃ ng:
GET /bff-api/order/list


ğŸ“ 9. Ghi chÃº má»Ÿ rá»™ng


CÃ³ thá»ƒ thÃªm RabbitMQ Ä‘á»ƒ event-driven Order & Payment


ThÃªm Email service, Notification service


Scale Redis + Postgres qua Docker Swarm / Kubernetes


TÃ¡ch Frontend & BFF hosting riÃªng



ğŸ‰ Káº¿t luáº­n
README nÃ y cung cáº¥p Ä‘áº§y Ä‘á»§:
âœ” Kiáº¿n trÃºc há»‡ thá»‘ng
âœ” API Flow
âœ” CÃ¡ch cháº¡y Docker
âœ” Cáº¥u hÃ¬nh Kong
âœ” Luá»“ng Order + Payment
âœ” MÃ´ táº£ toÃ n bá»™ microservices

Náº¿u báº¡n muá»‘n mÃ¬nh táº¡o sÆ¡ Ä‘á»“ kiáº¿n trÃºc dáº¡ng hÃ¬nh PNG, hoáº·c váº½ sequence diagram, cá»© báº£o mÃ¬nh nhÃ©!
